<!DOCTYPE html>
<html lang='en'>
<head>
<meta charset='utf-8'>
<meta content='IE=edge' http-equiv='X-UA-Compatible'>
<meta content='width=device-width, initial-scale=1.0' name='viewport'>
<title>
Matthias Vallentin - The Doom of Client-Side Wireless Network Security
</title>
<link href='/css/main.css' rel='stylesheet'>
<link href='/css/prism.css' rel='stylesheet'>
<script src='/js/all.js'></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src='https://www.googletagmanager.com/gtag/js?id=UA-1823891-1'></script>
<script>
window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-1823891-1');
</script>

</head>
<body>
<main>
<div class='grid-x grid-padding-x align-center'>
<div class='cell medium-10 large-8'>
<div class='content'>
<h1>
The Doom of Client-Side Wireless Network Security
</h1>
<div class='grid-x grid-padding-x align-justify margin-bottom-1'>
<div class='cell shrink'>
<span class='label radius'>
<i class='fa fa-calendar-o'></i>
2008-05-10
</span>
</div>
<div class='cell shrink'>
<span class='label radius secondary'>
browser
</span>
<span class='label radius secondary'>
cookies
</span>
<span class='label radius secondary'>
exploits
</span>
<span class='label radius secondary'>
metasploit
</span>
<span class='label radius secondary'>
wireless
</span>
</div>
</div>
<p>HD Moore <a href="http://hamsterswheel.com/techblog/?p=55">recently announced</a> the
integration of the <a href="http://www.theta44.org/karma">KARMA</a> tools with the
<a href="http://www.metasploit.com">metasploit</a> framework. The implications of this
fusion are devastating. In an interview with Patrick Gray, HD presents the new
powerful capabilities that take client-side wireless exploitation to a new
level. Technically, HD rewrote parts of the original KARMA driver, included 
<a href="http://digininja.org">some</a>
<a href="http://blog.metasploit.com/2008/02/rise-security-vs-asus-eee-pc.html">patches</a>,
and integrated the KARMA user-land daemons into the metasploit framework.</p>

<p>To illustrate the new potent features of metasploit, consider the following
scenario. A user opens his laptop on the plane to watch a DVD. If he ever
connected to an insecure access point, it will be in his list of list of
preferred wireless networks. Since the operating system attempts to connect to
all known wireless networks at boot time or when waking up from hibernation, it
sends out probes to look for known networks. An attacker, a couple of rows
behind, responds to the probes, provides an IP address to victim by DHCP and is
now rigged up to launch a multitude of client-side attacks.</p>

<p>Unaware of being owned, the victim’s mail client periodically tries to re-send
emails laying around in the outbox. The DNS request for the SMTP server is
intercepted by the attacker who returns his own address. Further, he mimics the
entire SMTP connection handshake when the victim connects. Thus the victim
sends his emails directly to the attacker through a fake SMTP channel.
This scenario extends of course to any other plain-text protocol (HTTP, FTP,
POP3, etc.). Clearly, the dominant position of the attacker yields
ample opportunity for more sophisticated client-side wireless attacks, as the
next examples by HD show.</p>

<ul>
  <li>
    <p><strong>Massive cookie stealing</strong>.  Traditional <a href="http://community.corest.com/~hochoa/wifizoo/index.html">cookie
stealing</a> presupposes
that the victim <em>actively</em> transmits a cookie from a particular web site in
order to be captured by the attacker. In contrast, this attack only requires
a single HTTP request to originate from the victim to hijack <em>all</em> cookies
from the victim’s browser. In general, only the requested site is allowed to
read that particular cookie. With a malicous server responding to all client
request, the attacker can bypass this restriction. When a victim sends a HTTP
request, the attacker returns a chosen list of web sites (say the current top
500 sites) and the browser then tries to connect to each site with the
corresponding cookie. Because all sites resolve back to the same attacker’s
hostname, all cookies arrive in the hands of the attacker. Thus, by merely
trying to access an arbitrary page in the Internet, the victim exposed all
his cookies that correspond to entry in the attacker’s list of sites.</p>
  </li>
  <li>
    <p><strong>Browser credential theft</strong>. The next interesting step from the attacker’s
perspective is it to hunt for usernames and passwords. To this end, HD wrote
a little script storing all form information of the top 500 websites, e.g.
forms asking for personal data, SSN, bank account number, MySpace and
Facebook logins, and so on. When the victim visits <em>any</em> arbitrary website,
the attackers returns a page full of frames that open the pages from the list
and contain the saved form snippets. If the victim enabled automatic form
fill-out in his browser preferences, the forms are auto-populated with
sensitive user data. In addition to the form snippets the attacker delivers a
malicious piece of JavaScript that grabs the form contents after filled out
by the browser and sends them back to the attacker.  Hence a single page
visit results in a complete compromise of the victim’s login credentials and
personal data.</p>
  </li>
  <li>
    <p><strong>Web-based SMB relay exploitation</strong>. Worse, if the victim happens to use
Internet Explorer, a <a href="http://perimetergrid.com/wp/2007/11/27/smb-reflection-made-way-too-easy">weakness</a> in Microsoft’s SMB file
sharing authentication protocol can be <a href="http://www.metasploit.net/data/confs/blackhat2007/tactical_paper.pdf">exploited</a> to
own the victim’s machine completely. By including a link pointing to a
network file share, the victim is forced to authenticate to the attacker’s
fake SMB server. This exposes the challenge key that can in turn fed back to
the client.  Essentially, the victim now authenticates against himself. Once
connected, the incoming connection is disconnected and the new session serves
as a vehicle to execute arbitrary shellcode.</p>
  </li>
</ul>

<p>Who knows what HD’s new toy features beyond the sketched scenarios? In any
case, these attack vectors witness how broken the actual model of wireless
security on the client-side is. While the industry tries to fix wireless
encryption schemes, the actual targets, the users themselves, are not
considered in the equation. These new techniques essentially render networking
in any wireless environment tremendously insecure.</p>


<div class='separator-center margin-bottom-2'></div>
<a class='button expanded hollow radius' href='#' id='show-comments' onclick='disqus();'>
Load Comments
</a>
<div id='disqus_thread'>
<script>
  var disqus_shortname = 'mavam';
  var disqus_config = function () {
    this.page.url = 'http://matthias.vallentin.net/blog/2008/05/10/the-doom-of-client-side-wireless-network-security/';
    this.page.identifier = '3054697649706319082';
  };
  var disqus_loaded = false;
  function disqus() {
    if (!disqus_loaded){
      disqus_loaded = true;
      var d = document, s = d.createElement('script');
      s.src = '//' + disqus_shortname +'.disqus.com/embed.js';
      s.setAttribute('data-timestamp', +new Date());
      (d.head || d.body).appendChild(s);
      // Hide the button after loading comments.
      d.getElementById('show-comments').style.display = 'none';
      return false;
    }
  };
</script>
</div>


</div>
</div>
</div>
</main>
<footer>
<div class='grid-x grid-padding-x'>
<div class='cell shrink show-for-medium'>
<div class='copyright'>
<i class='fa fa-copyright'></i>
2007-2018 Matthias Vallentin
</div>

</div>
<div class='cell auto'>
<ul class='menu vertical medium-horizontal'>
<li>
<a href='/#home'>
Home
</a>
</li>
<li>
<a href='/#bio'>
Bio
</a>
</li>
<li>
<a href='/#research'>
Research
</a>
</li>
<li>
<a href='/#presentations'>
Presentations
</a>
</li>
<li>
<a href='/#coursework'>
Course Work
</a>
</li>
<li>
<a href='/#projects'>
Projects
</a>
</li>
<li>
<a href='/#teaching'>
Teaching
</a>
</li>
<li>
<a href='/#blog'>
Blog
</a>
</li>
</ul>
</div>
<div class='cell shrink show-for-medium'>
<ul class='menu social'>
<li>
<a href='mailto:matthias@berkeley.edu'>
<i class='fa fa-envelope'></i>
</a>
</li>
<li>
<a href='https://www.linkedin.com/in/matthias-vallentin/'>
<i class='fa fa-linkedin'></i>
</a>
</li>
<li>
<a href='https://github.com/mavam'>
<i class='fa fa-github'></i>
</a>
</li>
</ul>

</div>
</div>
<div class='hide-for-medium'>
<ul class='menu social'>
<li>
<a href='mailto:matthias@berkeley.edu'>
<i class='fa fa-envelope'></i>
</a>
</li>
<li>
<a href='https://www.linkedin.com/in/matthias-vallentin/'>
<i class='fa fa-linkedin'></i>
</a>
</li>
<li>
<a href='https://github.com/mavam'>
<i class='fa fa-github'></i>
</a>
</li>
</ul>

<div class='copyright'>
<i class='fa fa-copyright'></i>
2007-2018 Matthias Vallentin
</div>

</div>

</footer>
<!-- Enable Foundation -->
<script>
  $(document).foundation();
</script>

</body>
</html>
